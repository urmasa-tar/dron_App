{% extends "base.html" %}

{% block content %}
<div class="container drone-detail">
    <h1>{{ drone.name }} <span class="badge badge-{{ 'success' if drone.status == 'connected' else 'secondary' }}">
        {{ drone.status }}
    </span></h1>
    
    <div class="drone-info">
        <div class="info-card">
            <h3>Подключение</h3>
            <p><strong>FCU URL:</strong> {{ drone.fcu_url }}</p>
            <p><strong>Node name:</strong> {{ drone.node_name }}</p>
            <p><strong>System ID:</strong> {{ drone.system_id }}</p>
        </div>
        
        <div class="info-card">
            <h3>Управление</h3>
            <button class="btn btn-connect" 
                    onclick="connectDrone({{ drone.id }})"
                    {{ 'disabled' if drone.status == 'connected' }}>
                Подключить
            </button>
            <a href="/download/launch/{{ drone.name }}" class="btn btn-download">
                Скачать launch-файл
            </a>
        </div>
    </div>
</div>

<script>
function connectDrone(droneId) {
    fetch(`/drone/${droneId}/connect`, {
        method: 'POST'
    })
    .then(response => response.text())
    .then(data => {
        alert(data);
        window.location.reload();
    })
    .catch(error => {
        alert('Ошибка подключения: ' + error);
    });
}
</script>
{% endblock %}